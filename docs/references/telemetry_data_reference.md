# Telemetry Data Reference

This document describes the telemetry data fields captured in sequence metadata and their sources.

## Telemetry Data Structure

All telemetry fields are nested in `metadata.telemetry_data` within each sequence.

```json
{
  "@type": "Sequence",
  "metadata": {
    "@type": "SequenceMetadata",
    "problem_id": 123,
    "template_id": "4008",
    "identifiers": ["2/3"],
    "mastery_tier": "BASELINE",
    "mastery_component": "CONCEPTUAL",
    "mastery_verb": "IDENTIFY",
    "telemetry_data": {
      "mastery_skill": "Identify fractions on pre-partitioned number line",
      "cognitive_verb": "IDENTIFY",
      "mastery_skill_id": "M4-05",
      "tier": "baseline",
      "non_curriculum_skills": ["click_accuracy", "reading_comprehension"],
      "misconception_id": [3, 6],
      "misconception_tag": ["numerator_denominator_as_independent", "reversing_numerator_and_denominator"]
    }
  }
}
```

## Field Definitions

### identifiers
- **Type:** array of strings
- **Format:** Array of fraction values
- **Example:** `["2/3"]` or `["2/3", "1/4"]`
- **Description:** Array of fractions covered in this sequence
- **Location:** At metadata level, not in telemetry_data
- **Used For:** Identifying which specific fractions/values are practiced in the question

### mastery_skill
- **Type:** string
- **Source:** Template `skill` field (via template_ref)
- **Example:** "Place a unit fraction on 0-1 number line by counting intervals from zero"
- **Description:** A concise description of the mathematical skill being practiced
- **Used For:** Analytics on skill mastery progression

### cognitive_verb
- **Type:** string
- **Source:** Template `mastery_verb` field (via template_ref)
- **Example:** "CREATE", "IDENTIFY", "COMPARE", "APPLY"
- **Description:** Bloom's taxonomy verb indicating cognitive level
- **Used For:** Tracking cognitive complexity across questions

### mastery_skill_id
- **Type:** string
- **Source:** Template `skill_id` field (via template_ref)
- **Example:** "M4-01", "M5-03"
- **Format:** `M{module_number}-{skill_number}`
- **Description:** Unique identifier for the skill within the module
- **Used For:** Skill-level analytics and reporting

### tier
- **Type:** string
- **Source:** Input variable `mastery_tier` (lowercase version)
- **Values:** "baseline", "support", "confidence", "stretch", "challenge"
- **Description:** Difficulty/scaffolding tier of the question
- **Used For:** Adaptive difficulty tracking, personalized learning paths

### non_curriculum_skills
- **Type:** array of strings
- **Source:** Auto-generated by godot_formatter based on `interaction_tool`
- **Example:** `["click_accuracy", "reading_comprehension"]`
- **Description:** Skills required to answer that aren't related to math content
- **Possible Values:**
  - `click_accuracy` - Precise clicking/tapping on targets
  - `drag_drop` - Dragging items to correct locations
  - `fine_motor_control` - Precise cursor/finger control
  - `reading_comprehension` - Understanding written instructions
  - `visual_discrimination` - Distinguishing similar visual elements
  - `visual_comparison` - Comparing multiple representations
  - `spatial_reasoning` - Understanding spatial relationships
  - `counting` - Counting intervals, ticks, spaces
  - `multiple_selection` - Selecting multiple items
  - `option_evaluation` - Evaluating MCQ options
  - `context_interpretation` - Understanding story contexts
  - `extended_number_line_reasoning` - Working with lines beyond 1
- **Used For:** Identifying barriers to success beyond content knowledge

### misconception_id
- **Type:** array of integers
- **Source:** Auto-generated by godot_formatter based on problem characteristics
- **Example:** `[3, 6]`, `[11]`, `[]`
- **Description:** IDs of misconceptions this question may reveal
- **Reference:** See `config/misconceptions.json` for full list
- **Used For:** Misconception-targeted remediation and reporting

### misconception_tag
- **Type:** array of strings
- **Source:** Auto-generated by godot_formatter based on problem characteristics
- **Example:** `["numerator_denominator_as_independent", "reversing_numerator_and_denominator"]`
- **Description:** Human-readable tags for misconceptions
- **Possible Values:**
  - `equal_vs_unequal_parts` (ID: 1)
  - `misidentifying_the_whole` (ID: 2)
  - `numerator_denominator_as_independent` (ID: 3)
  - `improper_spacing_on_number_line` (ID: 4)
  - `counting_tick_marks_instead_of_spaces` (ID: 5)
  - `reversing_numerator_and_denominator` (ID: 6)
  - `difficulty_recognizing_equivalence` (ID: 7)
  - `errors_comparing_unlike_fractions` (ID: 8)
  - `fractions_only_exist_in_shapes` (ID: 9)
  - `overgeneralizing_rules` (ID: 10)
  - `fractions_cant_exceed_one` (ID: 11)
- **Used For:** Human-readable misconception analysis

## Data Flow

```
┌─────────────────┐
│ Template File   │
│ (skill,         │──────┐
│  mastery_verb,  │      │
│  skill_id)      │      │
└─────────────────┘      │
                         │ template_ref
┌─────────────────┐      │
│ Input Variable  │      │
│ (mastery_tier)  │──────┼─────────┐
└─────────────────┘      │         │
                         ▼         ▼
                  ┌──────────────────────┐
                  │ Godot Formatter      │
                  │ - Maps fields        │
                  │ - Auto-generates:    │
                  │   * non_curriculum   │
                  │   * misconceptions   │
                  └──────────────────────┘
                         │
                         ▼
                  ┌──────────────────────┐
                  │ Sequence Metadata    │
                  │ telemetry_data: {    │
                  │   mastery_skill,     │
                  │   cognitive_verb,    │
                  │   mastery_skill_id,  │
                  │   tier,              │
                  │   non_curriculum_*,  │
                  │   misconception_*    │
                  │ }                    │
                  └──────────────────────┘
                         │
                         ▼
                  ┌──────────────────────┐
                  │ Metadata Mapper      │
                  │ (Post-processing)    │
                  └──────────────────────┘
                         │
                         ▼
                  ┌──────────────────────┐
                  │ Final Godot Sequence │
                  └──────────────────────┘
```

## Generation Logic

### Non-Curriculum Skills
Auto-generated based on `interaction_tool`:
- `place_point` → `["click_accuracy"]`
- `drag_label` → `["drag_drop", "fine_motor_control"]`
- `click_choice` → `["click_accuracy", "reading_comprehension"]`
- `select` → `["click_accuracy", "visual_discrimination"]`
- Plus contextual additions based on workspace characteristics

### Misconceptions
Auto-generated based on problem characteristics:
- **Fractions beyond 1** → misconception 11
- **Counting intervals** → misconception 5
- **Identifying fractions** → misconceptions 3, 6
- **Equal vs unequal intervals** → misconceptions 1, 4
- **Comparing fractions** → misconception 8
- See `docs/misconception_mapping_module4.md` for complete mapping

## Usage in Analytics

### Skill Progression Tracking
```sql
SELECT mastery_skill_id,
       AVG(score) as avg_score,
       COUNT(*) as attempts
FROM student_responses
WHERE student_id = ?
GROUP BY mastery_skill_id
ORDER BY mastery_skill_id
```

### Misconception Detection
```sql
SELECT misconception_tag,
       COUNT(*) as incorrect_attempts
FROM student_responses
WHERE student_id = ?
  AND is_correct = false
  AND misconception_id IS NOT NULL
GROUP BY misconception_tag
ORDER BY incorrect_attempts DESC
```

### Non-Curriculum Barriers
```sql
SELECT non_curriculum_skills,
       AVG(score) as avg_score
FROM student_responses
WHERE module_id = ?
GROUP BY non_curriculum_skills
HAVING avg_score < 0.7
```

## Related Files

- **Misconceptions Config:** `config/misconceptions.json`
- **Module 4 Mapping:** `docs/misconception_mapping_module4.md`
- **Godot Formatter:** `steps/prompts/godot_formatter.py`
- **Metadata Mapper:** `utils/metadata_mapper.py`
- **Template Files:**
  - `modules/module4/problem_templates.json`
  - `modules/module5/problem_templates_v2.json`
